{"version":3,"sources":["index.js"],"names":["ginit","backend_url","app","data","islogin","username","InputUrl","CustomKey","FlashStatus","FlashData","FormProccessing","methods","_this","this","GoogleAuth","gapi","auth2","getAuthInstance","currentUser","get","getAuthResponse","id_token","url","key","$","done","jqXHR","responseText","query","always","token","op","_this2","entries","console","log","logout","signOut","Date","s","toLocaleDateString","month","year","day","remove_http","replace","delete_confirm","e","target","currentTarget","dataset","tippy","interactive","appendTo","trigger","arrow","distance","destroy","content","document","querySelector","concat","innerHTML","_tippy","show","theme","one","hide","delete_entry","_this3","mask","addClass","setTimeout","removeClass","splice","findIndex","el","fail","googleUser","getBasicProfile","profile","getName","clipboard","ClipboardJS","on","placement","duration","clearSelection","hideAll"],"mappings":"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","file":"index.js","sourcesContent":["function ginit() { }\n\nconst backend_url = \"https://asia-northeast1-url-redirect-bb.cloudfunctions.net/redirect-node\";\n\nvar app = new Vue({\n    el: '#app',\n    data: {\n        islogin: false,\n        username: \"\",\n        InputUrl: \"\",\n        CustomKey: \"\",\n        FlashStatus: \"\",\n        FlashData: {},\n        FormProccessing: false,\n        entries: null\n    },\n    methods: {\n        create() {\n            this.FlashStatus = \"\";\n            this.FormProccessing = true;\n            let GoogleAuth = gapi.auth2.getAuthInstance();\n            let id_token = GoogleAuth.currentUser.get().getAuthResponse().id_token;\n            let data = {\n                token: id_token,\n                op: \"create\",\n                url: this.InputUrl,\n            };\n            if (this.CustomKey !== \"\") data.key = this.CustomKey;\n            $.get({\n                url: backend_url,\n                data: data,\n            }).done(data => {\n                this.InputUrl = \"\";\n                this.CustomKey = \"\";\n                this.FlashStatus = \"success\";\n                this.FlashData = data;\n                app.query();\n            }).fail(jqXHR => {\n                this.FlashData = jqXHR.responseText;\n                this.FlashStatus = \"failed\";\n            }).always(() => {\n                this.FormProccessing = false;\n            });\n        },\n        query() {\n            let GoogleAuth = gapi.auth2.getAuthInstance();\n            let id_token = GoogleAuth.currentUser.get().getAuthResponse().id_token;\n            let data = {\n                token: id_token,\n                op: \"query\"\n            };\n            $.get({\n                url: backend_url,\n                data: data,\n            }).done(data => {\n                this.entries = data.data;\n                console.log(data);\n            }).fail(jqXHR => {\n                this.FlashData = jqXHR.responseText;\n                this.FlashStatus = \"failed\";\n                this.entries = []\n            });\n        },\n        logout() {\n            let GoogleAuth = gapi.auth2.getAuthInstance();\n            GoogleAuth.signOut();\n            this.islogin = false;\n            this.FlashStatus = \"\";\n            this.entries = []\n        },\n        format_date(s) {\n            return new Date(s / 1000).toLocaleDateString(\"en-US\", { month: 'short', year: 'numeric', day: '2-digit' });\n        },\n        remove_http(s) {\n            return s.replace(/^https?:\\/\\//i, \"\");\n        },\n        delete_confirm(e) {\n            let target = e.currentTarget;\n            let key = target.dataset.key;\n            tippy(target, {\n                interactive: true,\n                appendTo: \"parent\",\n                trigger: \"manual\",\n                placement: \"bottom\",\n                arrow: true,\n                theme: \"light-border\",\n                distance: 5,\n                duration: [300, 50],\n                onHidden: (e) => {\n                    e.destroy();\n                },\n                content: document.querySelector(`.entry[data-key=\"${key}\"] .delete-confirm-template`).innerHTML\n            });\n            target._tippy.show();\n            $(`.tippy-tooltip .confirm-tip-btn[data-key=\"${key}\"]`).one('click', (e) => {\n                let key = e.currentTarget.dataset.key;\n                document.querySelector(`.entry-delete-btn[data-key=\"${key}\"]`)._tippy.hide();\n                app.delete_entry(key);\n            });\n            $(`.entry[data-key=\"${key}\"]`).one(\"mouseleave\", (e) => {\n                document.querySelector(`.entry-delete-btn[data-key=\"${e.currentTarget.dataset.key}\"]`)._tippy.hide();\n            });\n        },\n        delete_entry(key) {\n            let GoogleAuth = gapi.auth2.getAuthInstance();\n            let id_token = GoogleAuth.currentUser.get().getAuthResponse().id_token;\n            let data = {\n                token: id_token,\n                op: \"delete\",\n                key: key\n            };\n            $.get({\n                url: backend_url,\n                data: data,\n            }).done(() => {\n                let mask = $(\".entry[data-key=\\\"\" + key + \"\\\"] > .entry-deleted-mask\");\n                mask.addClass(\"show\");\n                setTimeout(() => {\n                    mask.removeClass(\"show\");\n                    this.entries.splice(this.entries.findIndex((el) => {\n                        return el.key === key;\n                    }), 1);\n                }, 1000);\n            }).fail(jqXHR => {\n                this.FlashData = jqXHR.responseText;\n                this.FlashStatus = \"failed\";\n            });\n        }\n    }\n});\n\nfunction onSignIn(googleUser) {\n    var profile = googleUser.getBasicProfile();\n    app.islogin = true;\n    app.username = profile.getName();\n    app.query();\n}\n\n\nvar clipboard = new ClipboardJS('.clip-btn');\n\nclipboard.on('success', function (e) {\n    tippy(e.trigger, {\n        content: \"Copied!\",\n        trigger: \"manual\",\n        placement: \"right\",\n        duration: [150, 200]\n    });\n    e.trigger._tippy.show();\n    setTimeout(() => {\n        e.trigger._tippy.hide();\n    }, 700);\n    e.clearSelection();\n});\n\nwindow.addEventListener('scroll', () => tippy.hideAll({ duration: 0 }));"]}